---
import Layout from '../../layouts/Layout.astro'
import Banner from '../../components/Banner.astro'
import { services } from '../../../data/services'
import CallAction from '../../components/CallAction.astro'
import { areas } from '../../../data/serviceAreas'

export async function getStaticPaths() {
  return services.map(service => ({
    params: { slug: service.slug }
  }))
}

const { slug } = Astro.params
const service = services.find(b => b.slug === slug)

if (!service) {
  throw new Error('Hizmet bulunamadı')
}

// Diğer blogları getir (mevcut blog hariç)
const otherBlogs = services.filter(b => b.slug !== slug).slice(0, 3)

const breadcrumbs = [
  { label: "Anasayfa", href: "/" },
  { label: "Hizmetler", href: "/hizmetler" },
  { label: service.title, href: `/hizmetler/${service.slug}` },
]

// Tarihi formatla
const formatDate = (dateString: string) => {
  const options: Intl.DateTimeFormatOptions = { 
    year: 'numeric', 
    month: 'long', 
    day: 'numeric' 
  }
  return new Date(dateString).toLocaleDateString('tr-TR', options)
}
---

<Layout>
  <div class="mt-20">
    <Banner
      title={service.title}
      image="/images/page-banner.webp"
      breadcrumbs={breadcrumbs}
    />
  </div>

  <div class="container mx-auto px-4 py-12">
    <div class="flex flex-col lg:flex-row gap-8">
      <!-- Ana İçerik -->
      <div class="lg:w-2/3">
        <article class="bg-white rounded-lg shadow-sm overflow-hidden">
          <div class="aspect-video overflow-hidden">
            <img 
              src={service.image || '/images/default-blog.jpg'} 
              alt={service.title}
              class="w-full h-full object-cover hover:scale-105 transition-transform duration-300"
            />
          </div>
          
          <!-- İçerik -->
          <div class="p-6 lg:p-8">
            
            <!-- Blog Başlığı -->
            <h1 class="text-3xl lg:text-4xl font-bold text-gray-900 mb-6 leading-tight">
              {service.title}
            </h1>
            
            <!-- Blog Açıklaması -->
            <div class="text-lg text-gray-700 mb-8 leading-relaxed">
              <p>{service.content}</p>
            </div>
            
            <!-- Blog İçeriği -->
            <div class="prose prose-lg max-w-none">
              {service.features && service.features.length > 0 ? (
                <div class="text-gray-700 leading-relaxed">
                  {service.features.map((feature, index) => (
                    <span>
                      {feature}
                      {index < service.features.length - 1 && <span class="mx-2 text-gray-400">|</span>}
                    </span>
                  ))}
                </div>
              ) : (
                <div class="text-gray-700 leading-relaxed space-y-4">
                  <p>Bursa Yakın Çekici</p>
                </div>
              )}
            </div>
          </div>
        </article>
        
        <!-- Etiketler -->
        {service.labels && service.labels.length > 0 && (
          <div class="mt-8 bg-white rounded-lg shadow-sm p-6">
            <h3 class="text-lg font-semibold text-gray-900 mb-4">Etiketler</h3>
            <div class="flex flex-wrap gap-2">
              {service.labels.map((tag) => (
                <span
                  class="inline-block bg-blue-50 text-blue-700 px-3 py-1 rounded-full text-sm font-medium hover:bg-blue-100 transition-colors cursor-pointer"
                >
                  #{tag}
                </span>
              ))}
            </div>
          </div>
        )}

      </div>
      
      <!-- Sidebar -->
      <div class="lg:w-1/3">
        <div class="sticky top-8 space-y-6">
          <!-- Hizmet Bölgeleri -->
          {areas.length > 0 && (
            <div class="bg-white rounded-lg shadow-sm p-6">
              <h3 class="text-lg font-semibold text-gray-900 mb-4 border-b border-gray-200 pb-2">
                Hizmet Bölgeleri
              </h3>
              <div class="space-y-4">
                {areas
                  .filter((area) => area.label === "İlce" || area.label === "Sehir")
                  .map((area) => (
                    <a href={`/hizmet-bolgeleri/${area.slug}`} title={area.name} class="block group hover:bg-gray-50 rounded-lg p-3 transition-colors">
                      <div class="flex gap-3 items-center">
                        <img src="../images/mapicon.svg" class="w-5 h-5" alt="bursa-yakin-cekici" title={area.name} />
                        <div class="flex-1 min-w-0">
                          <h4 class="text-sm font-medium text-gray-900 group-hover:text-red-600 transition-colors line-clamp-2 mb-1">
                            {area.name}
                          </h4>
                        </div>
                      </div>
                    </a>
                  ))}
              </div>
            </div>
          )}

        </div>
      </div>
    </div>
  </div>

  <CallAction />
</Layout>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  .prose h1, .prose h2, .prose h3, .prose h4, .prose h5, .prose h6 {
    color: #1f2937;
    font-weight: 600;
    margin-top: 1.5em;
    margin-bottom: 0.5em;
  }
  
  .prose p {
    margin-bottom: 1em;
  }
  
  .prose ul, .prose ol {
    margin-bottom: 1em;
  }
  
  .prose blockquote {
    border-left: 4px solid #3b82f6;
    padding-left: 1rem;
    margin: 1.5em 0;
    font-style: italic;
    color: #4b5563;
  }
</style>